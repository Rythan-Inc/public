/**
 * @license SheetJS - 10_ssf.js - 8508ad4 on Feb 21, 2018
 * (C) 2013-present SheetJS -- http://sheetjs.com
 * License: Apache 2
 * This code was copied and adapted from SheetJS/js-xls v1.5.11.
 *
 * https://github.com/SheetJS/js-xlsx/blob/master/bits/10_ssf.js
 */
var e={};!function(e){function t(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function r(e,t){for(var r="";r.length<t;)r+=e;return r}function a(e,t){var a=""+e;return a.length>=t?a:r("0",t-a.length)+a}function n(e,t){var a=""+e;return a.length>=t?a:r(" ",t-a.length)+a}function c(e,t){var a=""+e;return a.length>=t?a:a+r(" ",t-a.length)}e.version="0.10.2";var h=Math.pow(2,32);function l(e,t){return e>h||e<-h?function(e,t){var a=""+Math.round(e);return a.length>=t?a:r("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:r("0",t-a.length)+a}(Math.round(e),t)}function s(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],f=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function i(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}var o={};function g(e,t,r){for(var a=e<0?-1:1,n=e*a,c=0,h=1,l=0,s=1,u=0,f=0,i=Math.floor(n);u<t&&(l=(i=Math.floor(n))*h+c,f=i*u+s,!(n-i<5e-8));)n=1/(n-i),c=h,h=l,s=u,u=f;if(f>t&&(u>t?(f=s,l=c):(f=u,l=h)),!r)return[0,a*l,f];var o=Math.floor(a*l/f);return[o,a*l-o*f,f]}function d(e,t,r){if(e>2958465||e<0)return null;var a=0|e,n=Math.floor(86400*(e-a)),c=0,h=[],l={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,86400==++n&&(l.T=n=0,++a,++l.D)),60===a)h=r?[1317,10,29]:[1900,2,29],c=3;else if(0===a)h=r?[1317,8,29]:[1900,1,0],c=6;else{a>60&&--a;var s=new Date(1900,0,1);s.setDate(s.getDate()+a-1),h=[s.getFullYear(),s.getMonth()+1,s.getDate()],c=s.getDay(),a<60&&(c=(c+6)%7),r&&(c=0)}return l.y=h[0],l.m=h[1],l.d=h[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=c,l}i(o),e.parse_date_code=d;var b=new Date(1899,11,31,0,0,0),v=b.getTime(),m=new Date(1900,2,1,0,0,0);function p(e,t){var r=e.getTime();return t?r-=1262304e5:e>=m&&(r+=864e5),(r-(v+6e4*(e.getTimezoneOffset()-b.getTimezoneOffset())))/864e5}function M(e){return e.toString(10)}e._general_int=M;var A=function(){var e=/\.(\d*[1-9])0+$/,t=/\.0*$/,r=/\.(\d*[1-9])0+/,a=/\.0*[Ee]/,n=/(E[+-])(\d)$/;function c(r){return r.indexOf(".")>-1?r.replace(t,"").replace(e,".$1"):r}return function(t){var h,l=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return h=l>=-4&&l<=-1?t.toPrecision(8+l):Math.abs(l)<=7?function(e){var t=e<0?12:11,r=c(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(t):8===l?t.toFixed(8).substr(0,10):function(t){var r=t.toFixed(11).replace(e,".$1");return r.length>(t<0?12:11)&&(r=t.toPrecision(6)),r}(t),c(function(e){for(var t=0;t!=e.length;++t)if(101==(32|e.charCodeAt(t)))return e.replace(r,".$1").replace(a,"E").replace("e","E").replace(n,"$10$2");return e}(h))}}();function $(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e&&e<1e8?M(e):A(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return H(14,p(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function k(e,t,r,n){var c,h="",l=0,s=0,i=r.y,o=0;switch(e){case 98:i=r.y+543;case 121:switch(t.length){case 1:case 2:c=i%100,o=2;break;default:c=i%1e4,o=4}break;case 109:switch(t.length){case 1:case 2:c=r.m,o=t.length;break;case 3:return f[r.m-1][1];case 5:return f[r.m-1][0];default:return f[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,o=t.length;break;case 3:return u[r.q][0];default:return u[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,o=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,o=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,o=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(s=n>=2?3===n?1e3:100:1===n?10:1,(l=Math.round(s*(r.S+r.u)))>=60*s&&(l=0),"s"===t?0===l?"0":""+l/s:(h=a(l,2+n),"ss"===t?h.substr(0,2):"."+h.substr(2,t.length-1))):a(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":c=24*r.D+r.H;break;case"[m]":case"[mm]":c=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":c=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}o=3===t.length?1:2;break;case 101:c=i,o=1}return o>0?a(c,o):""}function w(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}e._general_num=A,e._general=$;var x=function(){var e=/%/g,h=/# (\?+)( ?)\/( ?)(\d+)/,s=/^#*0*\.([0#]+)/,u=/\).*[0#]/,f=/\(###\) ###\\?-####/;function i(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function o(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function d(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,t))}function b(v,m,p){if(40===v.charCodeAt(0)&&!m.match(u)){var M=m.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?b("n",M,p):"("+b("n",M,-p)+")"}if(44===m.charCodeAt(m.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return x(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(v,m,p);if(-1!==m.indexOf("%"))return function(t,a,n){var c=a.replace(e,""),h=a.length-c.length;return x(t,c,n*Math.pow(10,2*h))+r("%",h)}(v,m,p);if(-1!==m.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var c=t.indexOf(".");-1===c&&(c=t.indexOf("E"));var h=Math.floor(Math.log(r)*Math.LOG10E)%c;if(h<0&&(h+=c),-1===(a=(r/Math.pow(10,h)).toPrecision(n+1+(c+h)%c)).indexOf("e")){var l=Math.floor(Math.log(r)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(l-a.length+h):a+="E+"+(l-h);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,c)+"."+a.substr(2+c)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,a){return t+r+a.substr(0,(c+h)%c)+"."+a.substr(h)+"E"}))}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(m,p);if(36===m.charCodeAt(0))return"$"+b(v,m.substr(" "==m.charAt(1)?2:1),p);var A,$,k,O,E=Math.abs(p),y=p<0?"-":"";if(m.match(/^00+$/))return y+l(E,m.length);if(m.match(/^[#?]+$/))return"0"===(A=l(p,0))&&(A=""),A.length>m.length?A:i(m.substr(0,m.length-A.length))+A;if($=m.match(h))return function(e,t,c){var h=parseInt(e[4],10),l=Math.round(t*h),s=Math.floor(l/h),u=l-s*h,f=h;return c+(0===s?"":""+s)+" "+(0===u?r(" ",e[1].length+1+e[4].length):n(u,e[1].length)+e[2]+"/"+e[3]+a(f,e[4].length))}($,E,y);if(m.match(/^#+0+$/))return y+l(E,m.length-m.indexOf("0"));if($=m.match(s))return A=o(p,$[1].length).replace(/^([^\.]+)$/,"$1."+i($[1])).replace(/\.$/,"."+i($[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+r("0",i($[1]).length-t.length)})),-1!==m.indexOf("0.")?A:A.replace(/^0\./,".");if(m=m.replace(/^#+([0.])/,"$1"),$=m.match(/^(0*)\.(#*)$/))return y+o(E,$[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,$[1].length?"0.":".");if($=m.match(/^#{1,3},##0(\.?)$/))return y+w(l(E,0));if($=m.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+b(v,m,-p):w(""+(Math.floor(p)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(p,$[1].length)))+"."+a(d(p,$[1].length),$[1].length);if($=m.match(/^#,#*,#0/))return b(v,m.replace(/^#,#*,/,""),p);if($=m.match(/^([0#]+)(\\?-([0#]+))+$/))return A=t(b(v,m.replace(/[\\-]/g,""),p)),k=0,t(t(m.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return k<A.length?A.charAt(k++):"0"===e?"0":""})));if(m.match(f))return"("+(A=b(v,"##########",p)).substr(0,3)+") "+A.substr(3,3)+"-"+A.substr(6);var C="";if($=m.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min($[4].length,7),O=g(E,Math.pow(10,k)-1,!1),A=""+y," "==(C=x("n",$[1],O[1])).charAt(C.length-1)&&(C=C.substr(0,C.length-1)+"0"),A+=C+$[2]+"/"+$[3],(C=c(O[2],k)).length<$[4].length&&(C=i($[4].substr($[4].length-C.length))+C),A+=C;if($=m.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max($[1].length,$[4].length),7),y+((O=g(E,Math.pow(10,k)-1,!0))[0]||(O[1]?"":"0"))+" "+(O[1]?n(O[1],k)+$[2]+"/"+$[3]+c(O[2],k):r(" ",2*k+1+$[2].length+$[3].length));if($=m.match(/^[#0?]+$/))return A=l(p,0),m.length<=A.length?A:i(m.substr(0,m.length-A.length))+A;if($=m.match(/^([#0?]+)\.([#0]+)$/)){A=""+p.toFixed(Math.min($[2].length,10)).replace(/([^0])0+$/,"$1"),k=A.indexOf(".");var S=m.indexOf(".")-k,D=m.length-A.length-S;return i(m.substr(0,S)+A+m.substr(m.length-D))}if($=m.match(/^00,000\.([#0]*0)$/))return k=d(p,$[1].length),p<0?"-"+b(v,m,-p):w(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(p)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(k,$[1].length);switch(m){case"###,##0.00":return b(v,"#,##0.00",p);case"###,###":case"##,###":case"#,###":var F=w(l(E,0));return"0"!==F?y+F:"";case"###,###.00":return b(v,"###,##0.00",p).replace(/^0\./,".");case"#,###.00":return b(v,"#,##0.00",p).replace(/^0\./,".")}throw new Error("unsupported format |"+m+"|")}function v(l,o,d){if(40===l.charCodeAt(0)&&!o.match(u)){var b=o.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return d>=0?v("n",b,d):"("+v("n",b,-d)+")"}if(44===o.charCodeAt(o.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return x(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(l,o,d);if(-1!==o.indexOf("%"))return function(t,a,n){var c=a.replace(e,""),h=a.length-c.length;return x(t,c,n*Math.pow(10,2*h))+r("%",h)}(l,o,d);if(-1!==o.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var c=t.indexOf(".");-1===c&&(c=t.indexOf("E"));var h=Math.floor(Math.log(r)*Math.LOG10E)%c;if(h<0&&(h+=c),!(a=(r/Math.pow(10,h)).toPrecision(n+1+(c+h)%c)).match(/[Ee]/)){var l=Math.floor(Math.log(r)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(l-a.length+h):a+="E+"+(l-h),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,a){return t+r+a.substr(0,(c+h)%c)+"."+a.substr(h)+"E"}))}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(o,d);if(36===o.charCodeAt(0))return"$"+v(l,o.substr(" "==o.charAt(1)?2:1),d);var m,p,M,A,$=Math.abs(d),k=d<0?"-":"";if(o.match(/^00+$/))return k+a($,o.length);if(o.match(/^[#?]+$/))return m=""+d,0===d&&(m=""),m.length>o.length?m:i(o.substr(0,o.length-m.length))+m;if(p=o.match(h))return function(e,t,a){return a+(0===t?"":""+t)+r(" ",e[1].length+2+e[4].length)}(p,$,k);if(o.match(/^#+0+$/))return k+a($,o.length-o.indexOf("0"));if(p=o.match(s))return m=(m=(""+d).replace(/^([^\.]+)$/,"$1."+i(p[1])).replace(/\.$/,"."+i(p[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+r("0",i(p[1]).length-t.length)})),-1!==o.indexOf("0.")?m:m.replace(/^0\./,".");if(o=o.replace(/^#+([0.])/,"$1"),p=o.match(/^(0*)\.(#*)$/))return k+(""+$).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,p[1].length?"0.":".");if(p=o.match(/^#{1,3},##0(\.?)$/))return k+w(""+$);if(p=o.match(/^#,##0\.([#0]*0)$/))return d<0?"-"+v(l,o,-d):w(""+d)+"."+r("0",p[1].length);if(p=o.match(/^#,#*,#0/))return v(l,o.replace(/^#,#*,/,""),d);if(p=o.match(/^([0#]+)(\\?-([0#]+))+$/))return m=t(v(l,o.replace(/[\\-]/g,""),d)),M=0,t(t(o.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return M<m.length?m.charAt(M++):"0"===e?"0":""})));if(o.match(f))return"("+(m=v(l,"##########",d)).substr(0,3)+") "+m.substr(3,3)+"-"+m.substr(6);var O="";if(p=o.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return M=Math.min(p[4].length,7),A=g($,Math.pow(10,M)-1,!1),m=""+k," "==(O=x("n",p[1],A[1])).charAt(O.length-1)&&(O=O.substr(0,O.length-1)+"0"),m+=O+p[2]+"/"+p[3],(O=c(A[2],M)).length<p[4].length&&(O=i(p[4].substr(p[4].length-O.length))+O),m+=O;if(p=o.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return M=Math.min(Math.max(p[1].length,p[4].length),7),k+((A=g($,Math.pow(10,M)-1,!0))[0]||(A[1]?"":"0"))+" "+(A[1]?n(A[1],M)+p[2]+"/"+p[3]+c(A[2],M):r(" ",2*M+1+p[2].length+p[3].length));if(p=o.match(/^[#0?]+$/))return m=""+d,o.length<=m.length?m:i(o.substr(0,o.length-m.length))+m;if(p=o.match(/^([#0]+)\.([#0]+)$/)){m=""+d.toFixed(Math.min(p[2].length,10)).replace(/([^0])0+$/,"$1"),M=m.indexOf(".");var E=o.indexOf(".")-M,y=o.length-m.length-E;return i(o.substr(0,E)+m+o.substr(o.length-y))}if(p=o.match(/^00,000\.([#0]*0)$/))return d<0?"-"+v(l,o,-d):w(""+d).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(0,p[1].length);switch(o){case"###,###":case"##,###":case"#,###":var C=w(""+$);return"0"!==C?k+C:"";default:if(o.match(/\.[0#?]*$/))return v(l,o.slice(0,o.lastIndexOf(".")),d)+i(o.slice(o.lastIndexOf(".")))}throw new Error("unsupported format |"+o+"|")}return function(e,t,r){return(0|r)===r?v(e,t,r):b(e,t,r)}}();function O(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=O;var E=/\[[HhMmSs]*\]/;function y(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":s(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;)++t;++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(E))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":default:++t}return!1}function C(e,t,r,a){for(var n,c,h,l=[],u="",f=0,i="",o="t",g="H";f<e.length;)switch(i=e.charAt(f)){case"G":if(!s(e,f))throw new Error("unrecognized character "+i+" in "+e);l[l.length]={t:"G",v:"General"},f+=7;break;case'"':for(u="";34!==(h=e.charCodeAt(++f))&&f<e.length;)u+=String.fromCharCode(h);l[l.length]={t:"t",v:u},++f;break;case"\\":var b=e.charAt(++f),v="("===b||")"===b?b:"t";l[l.length]={t:v,v:b},++f;break;case"_":l[l.length]={t:"t",v:" "},f+=2;break;case"@":l[l.length]={t:"T",v:t},++f;break;case"B":case"b":if("1"===e.charAt(f+1)||"2"===e.charAt(f+1)){if(null==n&&null==(n=d(t,r,"2"===e.charAt(f+1))))return"";l[l.length]={t:"X",v:e.substr(f,2)},o=i,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":i=i.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==n&&null==(n=d(t,r)))return"";for(u=i;++f<e.length&&e.charAt(f).toLowerCase()===i;)u+=i;"m"===i&&"h"===o.toLowerCase()&&(i="M"),"h"===i&&(i=g),l[l.length]={t:i,v:u},o=i;break;case"A":case"a":var m={t:i,v:i};if(null==n&&(n=d(t,r)),"A/P"===e.substr(f,3).toUpperCase()?(null!=n&&(m.v=n.H>=12?"P":"A"),m.t="T",g="h",f+=3):"AM/PM"===e.substr(f,5).toUpperCase()?(null!=n&&(m.v=n.H>=12?"PM":"AM"),m.t="T",f+=5,g="h"):(m.t="t",++f),null==n&&"T"===m.t)return"";l[l.length]=m,o=i;break;case"[":for(u=i;"]"!==e.charAt(f++)&&f<e.length;)u+=e.charAt(f);if("]"!==u.slice(-1))throw'unterminated "[" block: |'+u+"|";if(u.match(E)){if(null==n&&null==(n=d(t,r)))return"";l[l.length]={t:"Z",v:u.toLowerCase()},o=u.charAt(1)}else u.indexOf("$")>-1&&(u=(u.match(/\$([^-\[\]]*)/)||[])[1]||"$",y(e)||(l[l.length]={t:"t",v:u}));break;case".":if(null!=n){for(u=i;++f<e.length&&"0"===(i=e.charAt(f));)u+=i;l[l.length]={t:"s",v:u};break}case"0":case"#":for(u=i;++f<e.length&&"0#?.,E+-%".indexOf(i=e.charAt(f))>-1||"\\"==i&&"-"==e.charAt(f+1)&&f<e.length-2&&"0#".indexOf(e.charAt(f+2))>-1;)u+=i;l[l.length]={t:"n",v:u};break;case"?":for(u=i;e.charAt(++f)===i;)u+=i;l[l.length]={t:i,v:u},o=i;break;case"*":++f," "!=e.charAt(f)&&"*"!=e.charAt(f)||++f;break;case"(":case")":l[l.length]={t:1===a?"t":i,v:i},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(u=i;f<e.length&&"0123456789".indexOf(e.charAt(++f))>-1;)u+=e.charAt(f);l[l.length]={t:"D",v:u};break;case" ":l[l.length]={t:i,v:i},++f;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(i))throw new Error("unrecognized character "+i+" in "+e);l[l.length]={t:"t",v:i},++f}var p,M=0,A=0;for(f=l.length-1,o="t";f>=0;--f)switch(l[f].t){case"h":case"H":l[f].t=g,o="h",M<1&&(M=1);break;case"s":(p=l[f].v.match(/\.0+$/))&&(A=Math.max(A,p[0].length-1)),M<3&&(M=3);case"d":case"y":case"M":case"e":o=l[f].t;break;case"m":"s"===o&&(l[f].t="M",M<2&&(M=2));break;case"X":break;case"Z":M<1&&l[f].v.match(/[Hh]/)&&(M=1),M<2&&l[f].v.match(/[Mm]/)&&(M=2),M<3&&l[f].v.match(/[Ss]/)&&(M=3)}switch(M){case 0:break;case 1:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M),n.M>=60&&(n.M=0,++n.H);break;case 2:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M)}var w,O="";for(f=0;f<l.length;++f)switch(l[f].t){case"t":case"T":case" ":case"D":break;case"X":l[f].v="",l[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[f].v=k(l[f].t.charCodeAt(0),l[f].v,n,A),l[f].t="t";break;case"n":case"(":case"?":for(w=f+1;null!=l[w]&&("?"===(i=l[w].t)||"D"===i||(" "===i||"t"===i)&&null!=l[w+1]&&("?"===l[w+1].t||"t"===l[w+1].t&&"/"===l[w+1].v)||"("===l[f].t&&(" "===i||"n"===i||")"===i)||"t"===i&&("/"===l[w].v||" "===l[w].v&&null!=l[w+1]&&"?"==l[w+1].t));)l[f].v+=l[w].v,l[w]={v:"",t:";"},++w;O+=l[f].v,f=w-1;break;case"G":l[f].t="t",l[f].v=$(t,r)}var C,S,D="";if(O.length>0){40==O.charCodeAt(0)?(C=t<0&&45===O.charCodeAt(0)?-t:t,S=x("(",O,C)):(S=x("n",O,C=t<0&&a>1?-t:t),C<0&&l[0]&&"t"==l[0].t&&(S=S.substr(1),l[0].v="-"+l[0].v)),w=S.length-1;var F=l.length;for(f=0;f<l.length;++f)if(null!=l[f]&&"t"!=l[f].t&&l[f].v.indexOf(".")>-1){F=f;break}var H=l.length;if(F===l.length&&-1===S.indexOf("E")){for(f=l.length-1;f>=0;--f)null!=l[f]&&-1!=="n?(".indexOf(l[f].t)&&(w>=l[f].v.length-1?(w-=l[f].v.length,l[f].v=S.substr(w+1,l[f].v.length)):w<0?l[f].v="":(l[f].v=S.substr(0,w+1),w=-1),l[f].t="t",H=f);w>=0&&H<l.length&&(l[H].v=S.substr(0,w+1)+l[H].v)}else if(F!==l.length&&-1===S.indexOf("E")){for(w=S.indexOf(".")-1,f=F;f>=0;--f)if(null!=l[f]&&-1!=="n?(".indexOf(l[f].t)){for(c=l[f].v.indexOf(".")>-1&&f===F?l[f].v.indexOf(".")-1:l[f].v.length-1,D=l[f].v.substr(c+1);c>=0;--c)w>=0&&("0"===l[f].v.charAt(c)||"#"===l[f].v.charAt(c))&&(D=S.charAt(w--)+D);l[f].v=D,l[f].t="t",H=f}for(w>=0&&H<l.length&&(l[H].v=S.substr(0,w+1)+l[H].v),w=S.indexOf(".")+1,f=F;f<l.length;++f)if(null!=l[f]&&(-1!=="n?(".indexOf(l[f].t)||f===F)){for(c=l[f].v.indexOf(".")>-1&&f===F?l[f].v.indexOf(".")+1:0,D=l[f].v.substr(0,c);c<l[f].v.length;++c)w<S.length&&(D+=S.charAt(w++));l[f].v=D,l[f].t="t",H=f}}}for(f=0;f<l.length;++f)null!=l[f]&&"n(?".indexOf(l[f].t)>-1&&(C=a>1&&t<0&&f>0&&"-"===l[f-1].v?-t:t,l[f].v=x(l[f].t,l[f].v,C),l[f].t="t");var T="";for(f=0;f!==l.length;++f)null!=l[f]&&(T+=l[f].v);return T}e.is_date=y,e._eval=C;var S=/\[[=<>]/,D=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function F(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function H(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:o)[e]}if(s(a,0))return $(t,r);t instanceof Date&&(t=p(t,r.date1904));var n=function(e,t){var r=O(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var c=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[a,c];if(null!=r[0].match(S)||null!=r[1].match(S)){var h=r[0].match(D),l=r[1].match(D);return F(t,h)?[a,r[0]]:F(t,l)?[a,r[1]]:[a,r[null!=h&&null!=l?2:1]]}return[a,c]}(a,t);if(s(n[1]))return $(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return C(n[1],t,r,n[0])}function T(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(null!=o[r]){if(o[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return o[t]=e,t}e.load=T,e._table=o,e.get_table=function(){return o},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&T(e[t],t)},e.init_table=i,e.format=H}(e);export default e;
